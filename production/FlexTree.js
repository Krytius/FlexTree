/**
 * FlexTree
 * @version: 0.0.1
 * @author: Elvis Ferreira Coelho (http://elviscoelho.net)
 * Date criation: 13/02/2014
 */
var Tree=function(a){var b,c,d,e,f=new TreeCreate,g=new TreeEvents,h=document.getElementById(a),i={},j={},k=function(){return i},l=function(a){b=a},m=function(){return b},n=function(a){c=a},o=function(){return c},p=function(a){d=a},q=function(){return d},r=function(a){e=a},s=function(){return e},t=function(a){i=a,u()},u=function(){if(h.className="mw-flextreeview",j={width:h.offsetWidth,height:h.offsetHeight},v(),b){var a=w();h.appendChild(a)}var c=x();h.appendChild(c)},v=function(){f.init(D),g.init(D)},w=function(){var a=y("div");if(a.className="mw-title",c){var d=y("i");d.className="icon",d.style.backgroundImage="url("+c+")",a.appendChild(d)}var e=y("div");return e.className="text",e.innerHTML=b,a.appendChild(e),a},x=function(){var a=y("div");a.className="mw-tree-view";var b=f.createTree(i);return a.appendChild(b),a},y=function(a){return document.createElement(a)},z=function(a){var b=document.querySelectorAll(a);return b.length>1?b[0]:b},A=function(a,b){b&&(b.className+=a)},B=function(a,b){b&&(b.className=b.className.replace(a,""))},C=function(a,b,c){c&&(c.className=c.className.replace(a,b))},D={treeCreate:f,treeEvents:g,object:i,init:t,getObject:k,getTitle:m,getIcon:o,setTitle:l,setIcon:n,setColapse:p,getColapse:q,setCheck:r,getCheck:s,create:y,selector:z,addClass:A,removeClass:B,replaceClass:C,element:h,setMonitorEvent:g.setMonitorEvents};return D},TreeCreate=function(){var a={},b=function(b){a=b},c=function(a,b,d){d?d+=1:d=1;for(var e=a.length,f=0;e>f;f++)if(a[f].id===b)return d;for(var g,f=0;e>f;f++){var h=a[f].filho?1:0;if(h&&(g=c(a[f].filho,b,d)),g)return g}},d=function(a,b){for(var c=a.length,e=0;c>e;e++)if(a[e].id===b&&a[e].filho)return a[e].filho;for(var f,e=0;c>e;e++){var g=a[e].filho?1:0;if(g&&(f=d(a[e].filho,b)),f)return f}},e=function(b){var d=b.length,i=a.create("div");i.setAttribute("id","mw-content-tree");for(var j=0;d>j;j++){var k=c(a.getObject(),b[j].id),l=b[j].filho?1:0,m=a.create("div");m.className="mw-topic",m.setAttribute("data-id",b[j].id),m.setAttribute("group-id",b[j].idGroup),m.style.width=g(k)+"px",a.getCheck()||(m.onclick=a.treeEvents.openCloseGroup);var n=a.create("div");if(n.className="mw-title-tree",n.innerHTML=b[j].nome,n.style.width=h(m)+"px",n.onclick=a.treeEvents.eventsTitle,m.appendChild(n),a.getCheck()){var o=a.create("div");o.className=b[j].check?"checkActive":"checkInative",o.setAttribute("id","mw-check"),o.onclick=a.treeEvents.markDesmarkCheck,m.appendChild(o)}if(l){var p=f();a.getCheck()&&(p.onclick=a.treeEvents.openCloseGroup),m.appendChild(p)}if(i.appendChild(m),k>1&&(m.parentNode.setAttribute("data-id",b[j].id),m.parentNode.setAttribute("group-id",b[j].idGroup),m.parentNode.className="mw-group",m.parentNode.style.display=a.getColapse()?"block":"none"),l){var q=e(b[j].filho);i.appendChild(q)}}return i},f=function(){var b=a.create("i");return b.className="arrowInactive",b},g=function(b){var c=a.element.offsetWidth-20*(b?b:0);return c},h=function(b){var c=parseInt(b.style.width)-(a.getCheck()?40:25);return c},i={init:b,createTree:e,returnTreeDown:d};return i},TreeEvents=function(){var a,b={},c=[],d=function(a){b=a},e=function(a){c=a},f=function(){return c},g=function(){var a,c;"arrow"===this.className.substr(0,5)?(a=this.parentNode,c=this):(a=this,c=this.childNodes[this.childNodes.length-1]);var d=a.getAttribute("data-id"),e=b.selector('.mw-group[group-id="'+d+'"]')[0];"block"===e.style.display?(e.style.display="none",b.replaceClass("arrowActive","arrowInactive",c)):(e.style.display="block",b.replaceClass("arrowInactive","arrowActive",c))},h=function(){var a;a="check"===this.className.substr(0,5)?this:this.parentNode.childNodes[1],j(a)},i=function(){var a=this.parentNode.getAttribute("data-id");b.getCheck()&&j(b.selector('.mw-topic[data-id="'+a+'"] #mw-check')[0])},j=function(a){var c=a.parentNode.getAttribute("data-id"),d=!1;"checkActive"===a.className?(d=!1,b.replaceClass("checkActive","checkInative",a),l(c)):(d=!0,b.replaceClass("checkInative","checkActive",a),m(c));var e=b.treeCreate.returnTreeDown(b.getObject(),c);e&&k(e,d)},k=function(a,c){for(var d=a.length,e=0;d>e;e++){var f=b.selector('.mw-topic[data-id="'+a[e].id+'"][group-id="'+a[e].idGroup+'"] #mw-check')[0];c?(b.replaceClass("checkInative","checkActive",f),m(a[e].id)):(b.replaceClass("checkActive","checkInative",f),l(a[e].id)),a[e].filho&&k(a[e].filho,c)}},l=function(b){if(c.length>0){var d=c.indexOf(b);c.splice(d,1),a(b,!1,c)}},m=function(b){c.push(b),a(b,!0,c)},n=function(b,c){switch(b){case"OnCheck":a=c}},o={init:d,openCloseGroup:g,markDesmarkCheck:h,eventsTitle:i,setSelected:e,getSelected:f,setMonitorEvents:n};return o};